---
alwaysApply: false
---
## ðŸ“¦ Stack & Technologies Krosmozâ€‘JDR

- **Backend** : Laravel 12 (PHP 8.4), MySQL (`krosmozDB`), secrets gÃ©rÃ©s via `.env` (ne **jamais** versionner ce fichier).
- **Frontend** : Vue 3, SCSS, Tailwind CSS + DaisyUI, Tiptap comme Ã©diteur WYSIWYG, outil de build esbuild/rollup, multi-langues via vue-i18n, pnpm.
- **Tests** : PHPUnit (backend), Vitest ou Jest (frontend), Cypress en end-to-end.
- **CI/CD** : pipelines GitHub ou GitLab CI automatisant le lint, les tests, le build et le dÃ©ploiement.
- Docs projet Ã  jour dans `/docs/` (notamment `TECHNOLOGIES.md`, `PROJECT_STRUCTURE.md`).

## ðŸŽ­ Outils Playwright locaux

### âœ… Scripts Playwright (installÃ©s et configurÃ©s)
- **Localisation** : Dossier `playwright/` Ã  la racine du projet
- **Navigateur** : WebKit (compatible WSL2 ARM64)
- **Utilisation** : Scripts Node.js locaux pour l'automatisation des tests et du dÃ©veloppement
- **FonctionnalitÃ©s** : navigation, clics, remplissage de formulaires, capture d'Ã©cran, tests de connexion

### ðŸš€ Utilisation rapide
```bash
# Navigation rapide vers localhost:8000
node playwright/run.js nav

# Connexion automatique
node playwright/run.js login-admin
node playwright/run.js login-test

# Capture d'Ã©cran rapide
node playwright/run.js ss ma-capture.png

# AccÃ¨s Ã  la console
node playwright/run.js console http://localhost:8000 --output=console.log --timeout=60000

# AccÃ¨s aux requÃªtes rÃ©seau
node playwright/run.js network http://localhost:8000 --filter=GET,POST --output=network.log --timeout=60000

# Afficher l'aide
node playwright/run.js help
```

### ðŸ“ Structure des outils
```
playwright/
â”œâ”€â”€ README.md                 # Documentation complÃ¨te
â”œâ”€â”€ playwright-universal.js   # Classe universelle Playwright
â”œâ”€â”€ playwright-cli.js         # Interface CLI complÃ¨te
â”œâ”€â”€ run.js                   # Script de raccourci simplifiÃ©
â”œâ”€â”€ tools/                   # Outils de base
â”‚   â”œâ”€â”€ auto-login.js        # Connexion automatique
â”‚   â”œâ”€â”€ console-monitor.js   # Monitoring de la console
â”‚   â””â”€â”€ network-monitor.js   # Monitoring du rÃ©seau
â”œâ”€â”€ tasks/                   # Scripts de tÃ¢ches spÃ©cifiques
â”‚   â”œâ”€â”€ test-login.js        # Test de connexion
â”‚   â”œâ”€â”€ test-navigation.js   # Test de navigation
â”‚   â””â”€â”€ test-authenticated-workflow.js # Tests de workflow authentifiÃ©
â”œâ”€â”€ config/                  # Configuration
â”‚   â””â”€â”€ test-users.js        # Configuration des utilisateurs de test
â”œâ”€â”€ docs/                    # Documentation
â”‚   â””â”€â”€ AUTO_LOGIN_GUIDE.md  # Guide de connexion automatique
â”œâ”€â”€ screenshots/             # Captures d'Ã©cran gÃ©nÃ©rÃ©es
â””â”€â”€ temp/                   # Fichiers temporaires (logs, scripts temporaires, screenshots temporaires)
```

---

## ðŸ”„ Workflow recommandÃ© de l'IA

1. **Avant toute modification front-end** : Utiliser les scripts Playwright pour reproduire le workflow sur le site local
2. **Pour du debug interactif** : Utiliser `node playwright/run.js nav` pour analyser l'interface
3. **Pour les tests de formulaires** : Utiliser `node playwright/run.js login` ou crÃ©er des scripts personnalisÃ©s
4. **Pour la capture d'Ã©crans** : Utiliser `node playwright/run.js ss` pour documenter les interfaces
5. **Les modifications backend** passent par l'analyse du code Laravel et des migrations existantes

---

## ðŸ“ RÃ©fÃ©rences documentation

- `/docs/docs.index.json`, `/docs/00-Project/TECHNOLOGIES.md`, `/docs/10-BestPractices/PROJECT_STRUCTURE.md`
- `playwright/README.md` - Documentation complÃ¨te des outils Playwright
- [Documentation Playwright officielle](https://playwright.dev/docs/)

---

## ðŸ’¬ Conseils de rÃ©daction des prompts

- **Mentionner explicitement** l'utilisation des scripts Playwright locaux
- **DÃ©crire les actions** de maniÃ¨re directive et sÃ©quencÃ©e
- **Utiliser les raccourcis** quand possible (`nav`, `ss`, etc.)

### Exemples de prompts :
> "Utilise les scripts Playwright pour naviguer vers localhost:8000 et capturer une capture d'Ã©cran de la page de connexion"
> "Teste le formulaire de connexion avec les scripts Playwright et capture les erreurs Ã©ventuelles"
> "Utilise `node playwright/run.js nav` pour analyser l'interface utilisateur"

---

## âš ï¸ Points de vigilance

### ProblÃ¨mes connus avec le serveur MCP Playwright
- **WSL2 ARM64** : Le serveur MCP Playwright pose des problÃ¨mes sur cette architecture
- **Chrome non supportÃ©** : Chrome n'est pas disponible pour WSL2 ARM64
- **Configuration complexe** : Le serveur MCP nÃ©cessite des configurations spÃ©cifiques qui ne fonctionnent pas toujours

### Solution adoptÃ©e
- **Scripts locaux** : Utilisation de scripts Node.js Playwright locaux
- **WebKit** : Navigateur compatible avec WSL2 ARM64
- **Organisation propre** : Scripts isolÃ©s dans le dossier `playwright/`

### Avantages de l'approche locale
- **FiabilitÃ©** : Pas de dÃ©pendance au serveur MCP
- **FlexibilitÃ©** : Scripts personnalisables selon les besoins
- **Performance** : ExÃ©cution directe sans latence rÃ©seau
- **Debugging** : Logs dÃ©taillÃ©s et contrÃ´le total

---

## ðŸš€ Installation et configuration

### PrÃ©requis
```bash
# Installation des navigateurs Playwright
npx playwright install webkit

# VÃ©rification de l'installation
node playwright/run.js help
```

### Configuration WebKit (recommandÃ©e pour WSL2 ARM64)
- **Navigateur** : WebKit (compatible ARM64)
- **Architecture** : Support complet WSL2 ARM64
- **Performance** : OptimisÃ© pour les tests automatisÃ©s

---

## ðŸŽ¯ Cas d'usage typiques pour KrosmozJdr

### Tests E2E automatisÃ©s
- Test de connexion automatique : `node playwright/run.js login-admin`
- Test de crÃ©ation d'un personnage : `node playwright/run.js test-form`
- Test de navigation entre les pages de campagne : `node playwright/run.js nav`
- Test des formulaires de crÃ©ation d'entitÃ©s (sorts, objets, etc.)
- Validation de l'interface utilisateur responsive
- Tests de workflow authentifiÃ©s : `node playwright/tasks/test-authenticated-workflow.js`

### GÃ©nÃ©ration de documentation
- Capture d'Ã©crans automatiques des pages principales : `node playwright/run.js ss`
- Documentation des workflows utilisateur
- Validation visuelle des composants UI

### Debug et dÃ©veloppement
- Analyse des erreurs console en temps rÃ©el
- Test des interactions utilisateur complexes
- Validation des performances de l'application

---

## ðŸ”§ CrÃ©ation de scripts personnalisÃ©s
Les scripts personnalisÃ©s doivent Ãªtre organisÃ©s selon leur usage :
- **`playwright/temp/`** : Scripts temporaires, logs, screenshots temporaires
- **`playwright/tasks/`** : Scripts de tÃ¢ches spÃ©cifiques qui peuvent servir de temps en temps
- **`playwright/tools/`** : Outils de base rÃ©utilisables (connexion, monitoring, etc.)

### Utiliser la classe PlaywrightUniversal
```javascript
import { runPlaywrightTask } from './playwright/playwright-universal.js';

runPlaywrightTask('Ma tÃ¢che personnalisÃ©e', async (pw) => {
  await pw.navigate('http://localhost:8000');
  await pw.click('#mon-bouton');
  await pw.screenshot('resultat.png');
});
```

### Ajouter de nouvelles commandes CLI
Modifier `playwright/playwright-cli.js` pour ajouter de nouvelles tÃ¢ches.

---

### âœ… Pourquoi cette rule est pertinente

- **AlwaysApply = true** : L'IA a en permanence un contexte clair sur la stack et les outils disponibles
- **Instruction explicite** sur l'utilisation des scripts Playwright locaux
- **Solution robuste** pour WSL2 ARM64 sans dÃ©pendance au serveur MCP
- **Organisation propre** avec documentation complÃ¨te
- **FlexibilitÃ© maximale** pour les tests et l'automatisation

---

> ðŸ’¡ **Note** : Cette approche remplace efficacement le serveur MCP Playwright tout en Ã©tant plus fiable et adaptÃ©e Ã  l'environnement WSL2 ARM64.
