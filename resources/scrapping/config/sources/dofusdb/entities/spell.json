{
  "version": 1,
  "source": "dofusdb",
  "entity": "spell",
  "label": "Sorts",
  "meta": {
    "notes": "DofusDB : id, name, description, img, breedId, levels[].apCost, range, grade, maxCastPerTurn, effects[].zoneDescr.shape. KrosmozJDR : spells (name, description, area, level, po, pa, cast_per_turn, image). effect non mapp√© en V2 (formatter packDofusdbEffects absent)."
  },
  "endpoints": {
    "fetchOne": {
      "pathTemplate": "/spells/{id}",
      "method": "GET",
      "queryDefaults": { "lang": "{lang}" }
    },
    "fetchMany": {
      "path": "/spells",
      "method": "GET",
      "queryDefaults": { "lang": "{lang}", "$limit": 50, "$skip": 0 }
    }
  },
  "filters": {
    "supported": [
      { "key": "id", "type": "number" },
      { "key": "idMin", "type": "number" },
      { "key": "idMax", "type": "number" },
      { "key": "name", "type": "string" },
      { "key": "breedId", "type": "number" }
    ]
  },
  "target": {
    "krosmozEntity": "spell",
    "primaryKey": { "sourceField": "id", "targetField": "dofusdb_id" },
    "autoUpdateField": "auto_update"
  },
  "mapping": [
    {
      "key": "dofusdb_id",
      "from": { "path": "id" },
      "to": [{ "model": "spells", "field": "dofusdb_id" }],
      "formatters": [{ "name": "toString", "args": {} }]
    },
    {
      "key": "name",
      "from": { "path": "name", "langAware": true },
      "to": [{ "model": "spells", "field": "name" }],
      "formatters": [{ "name": "pickLang", "args": { "lang": "{lang}", "fallback": "fr" } }]
    },
    {
      "key": "description",
      "from": { "path": "description", "langAware": true },
      "to": [{ "model": "spells", "field": "description" }],
      "formatters": [{ "name": "pickLang", "args": { "lang": "{lang}", "fallback": "fr" } }]
    },
    {
      "key": "image",
      "from": { "path": "img" },
      "to": [{ "model": "spells", "field": "image" }],
      "formatters": [{ "name": "storeScrappedImage", "args": { "entityFolder": "spells", "idPath": "id" } }]
    },
    {
      "key": "pa",
      "from": { "path": "levels.0.apCost" },
      "to": [{ "model": "spells", "field": "pa" }],
      "formatters": [
        { "name": "toInt", "args": {} },
        { "name": "clampToCharacteristic", "args": { "characteristicId": "pa" } }
      ]
    },
    {
      "key": "po",
      "from": { "path": "levels.0.range" },
      "to": [{ "model": "spells", "field": "po" }],
      "formatters": [
        { "name": "toInt", "args": {} },
        { "name": "clampToCharacteristic", "args": { "characteristicId": "po" } },
        { "name": "toString", "args": {} }
      ]
    },
    {
      "key": "spell_po_min",
      "from": { "path": "levels.0.range.min" },
      "to": [{ "model": "spells", "field": "spell_po_min" }],
      "formatters": [
        { "name": "nullableInt", "args": {} },
        { "name": "clampToCharacteristic", "args": { "characteristicId": "spell_po_min" } }
      ]
    },
    {
      "key": "spell_po_max",
      "from": { "path": "levels.0.range.max" },
      "to": [{ "model": "spells", "field": "spell_po_max" }],
      "formatters": [
        { "name": "nullableInt", "args": {} },
        { "name": "clampToCharacteristic", "args": { "characteristicId": "spell_po_max" } }
      ]
    },
    {
      "key": "area",
      "from": { "path": "levels.0.effects.0.zoneDescr.shape" },
      "to": [{ "model": "spells", "field": "area" }],
      "formatters": [
        { "name": "nullableInt", "args": {} },
        { "name": "clampToCharacteristic", "args": { "characteristicId": "area" } }
      ]
    },
    {
      "key": "level",
      "from": { "path": "levels.0.grade" },
      "to": [{ "model": "spells", "field": "level" }],
      "formatters": [
        { "name": "toInt", "args": {} },
        { "name": "clampToCharacteristic", "args": { "characteristicId": "level" } },
        { "name": "toString", "args": {} }
      ]
    },
    {
      "key": "cast_per_turn",
      "from": { "path": "levels.0.maxCastPerTurn" },
      "to": [{ "model": "spells", "field": "cast_per_turn" }],
      "formatters": [
        { "name": "toInt", "args": {} },
        { "name": "clampToCharacteristic", "args": { "characteristicId": "cast_per_turn" } },
        { "name": "toString", "args": {} }
      ]
    },
    {
      "key": "cast_per_target",
      "from": { "path": "levels.0.maxCastPerTarget" },
      "to": [{ "model": "spells", "field": "cast_per_target" }],
      "formatters": [
        { "name": "nullableInt", "args": {} },
        { "name": "clampToCharacteristic", "args": { "characteristicId": "cast_per_target" } },
        { "name": "toString", "args": {} }
      ]
    },
    {
      "key": "sight_line",
      "from": { "path": "levels.0.needLineOfSight" },
      "to": [{ "model": "spells", "field": "sight_line" }],
      "formatters": [
        { "name": "toInt", "args": {} },
        { "name": "clampToCharacteristic", "args": { "characteristicId": "sight_line" } }
      ]
    },
    {
      "key": "number_between_two_cast",
      "from": { "path": "levels.0.minCastInterval" },
      "to": [{ "model": "spells", "field": "number_between_two_cast" }],
      "formatters": [
        { "name": "nullableInt", "args": {} },
        { "name": "clampToCharacteristic", "args": { "characteristicId": "number_between_two_cast" } },
        { "name": "toString", "args": {} }
      ]
    },
    {
      "key": "number_between_two_cast_editable",
      "from": { "path": "levels.0.minCastIntervalEditable" },
      "to": [{ "model": "spells", "field": "number_between_two_cast_editable" }],
      "formatters": [
        { "name": "toInt", "args": {} },
        { "name": "clampToCharacteristic", "args": { "characteristicId": "number_between_two_cast_editable" } }
      ]
    },
    {
      "key": "po_editable",
      "from": { "path": "levels.0.rangeEditable" },
      "to": [{ "model": "spells", "field": "po_editable" }],
      "formatters": [
        { "name": "toInt", "args": {} },
        { "name": "clampToCharacteristic", "args": { "characteristicId": "po_editable" } }
      ]
    },
    {
      "key": "element",
      "from": { "path": "elementId" },
      "to": [{ "model": "spells", "field": "element" }],
      "formatters": [
        { "name": "nullableInt", "args": {} },
        { "name": "clampToCharacteristic", "args": { "characteristicId": "element" } }
      ]
    },
    {
      "key": "category",
      "from": { "path": "categoryId" },
      "to": [{ "model": "spells", "field": "category" }],
      "formatters": [
        { "name": "nullableInt", "args": {} },
        { "name": "clampToCharacteristic", "args": { "characteristicId": "category" } }
      ]
    },
    {
      "key": "is_magic",
      "from": { "path": "levels.0.isMagic" },
      "to": [{ "model": "spells", "field": "is_magic" }],
      "formatters": [
        { "name": "toInt", "args": {} },
        { "name": "clampToCharacteristic", "args": { "characteristicId": "is_magic" } }
      ]
    },
    {
      "key": "powerful",
      "from": { "path": "levels.0.powerful" },
      "to": [{ "model": "spells", "field": "powerful" }],
      "formatters": [
        { "name": "nullableInt", "args": {} },
        { "name": "clampToCharacteristic", "args": { "characteristicId": "powerful" } }
      ]
    }
  ]
}
